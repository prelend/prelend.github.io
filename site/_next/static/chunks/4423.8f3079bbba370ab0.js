"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4423],{25935:function(e,r,t){t.d(r,{B:function(){return h}});var n=t(59499),o=t(4730),s=t(49501),a=t(30120),i=t(91655),c=t(70794),l=t(57609),u=t(41024),d=t(58527),p=t(85893),x=["loading","outputAmountUSD","inputAmountUSD"];function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?m(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var h=function(e){var r=e.loading,t=e.outputAmountUSD,n=e.inputAmountUSD,m=(0,o.Z)(e,x),h=new c.Z(t).minus(n),y=n&&"0"!==n?h.dividedBy(n).times(100).toFixed(2):"0";return"-0.00"===y&&(y="0.00"),(0,p.jsx)(d.G,v(v({variant:"secondary12",color:"text.secondary",event:{eventName:l.vh.TOOL_TIP,eventParams:{tooltip:"Price Impact"}},text:(0,p.jsx)(a.Z,{sx:{display:"flex",alignItems:"center"},children:(0,p.jsx)(s.cC,{id:"Price impact {0}%",values:{0:r?(0,p.jsx)(i.Z,{variant:"rectangular",height:12,width:25,sx:{borderRadius:"4px",display:"flex",marginLeft:"4px"}}):(0,p.jsx)(u.B,{value:y,visibleDecimals:2,variant:"secondary12",color:"text.secondary",sx:{marginLeft:"4px"}})}})})},m),{},{children:(0,p.jsx)(s.cC,{id:"Price impact is the spread between the total value of the entry tokens switched and the destination tokens obtained (in USD), which results from the limited liquidity of the trading pair."})}))}},54423:function(e,r,t){t.r(r),t.d(r,{DebtSwitchModal:function(){return Pe}});var n=t(59499),o=t(49501),s=t(67294),a=t(31959),i=t(8195),c=t(94635),l=t(90116),u=t(17674),d=t(75331),p=t(1279),x=t(21046),m=t(52358),v=t(80227),h=t(9144),y=t(29630),b=t(81645),f=t(30120),g=t(63366),j=t(87462),w=t(86010),S=t(94780),A=t(81719),T=t(78884),D=t(36622),O=t(34867);function k(e){return(0,O.Z)("MuiListSubheader",e)}(0,t(1588).Z)("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);var B=t(85893);const P=["className","color","component","disableGutters","disableSticky","inset"],Z=(0,A.ZP)("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,"default"!==t.color&&r[`color${(0,D.Z)(t.color)}`],!t.disableGutters&&r.gutters,t.inset&&r.inset,!t.disableSticky&&r.sticky]}})((({theme:e,ownerState:r})=>(0,j.Z)({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14)},"primary"===r.color&&{color:(e.vars||e).palette.primary.main},"inherit"===r.color&&{color:"inherit"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.inset&&{paddingLeft:72},!r.disableSticky&&{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper})));var C=s.forwardRef((function(e,r){const t=(0,T.Z)({props:e,name:"MuiListSubheader"}),{className:n,color:o="default",component:s="li",disableGutters:a=!1,disableSticky:i=!1,inset:c=!1}=t,l=(0,g.Z)(t,P),u=(0,j.Z)({},t,{color:o,component:s,disableGutters:a,disableSticky:i,inset:c}),d=(e=>{const{classes:r,color:t,disableGutters:n,inset:o,disableSticky:s}=e,a={root:["root","default"!==t&&`color${(0,D.Z)(t)}`,!n&&"gutters",o&&"inset",!s&&"sticky"]};return(0,S.Z)(a,k,r)})(u);return(0,B.jsx)(Z,(0,j.Z)({as:s,className:(0,w.default)(d.root,n),ref:r,ownerState:u},l))})),I=t(61702),E=t(70794),R=t(99552),M=t(25935),F=t(41024),N=t(68861),Y=t(72667),U=t(69331),G=t(53601),L=t(57824),W=t(50029),H=t(87794),_=t.n(H),q=t(74119),V=t(46930),z=t(77537),Q=t(20301),X=t(8656),K=t(59286),$=t(69125),J=t(34220),ee=t(93608),re=t(99730),te=t(80854),ne=t(56371),oe=t(30194),se=t(89291),ae=t(19419),ie=t(32113),ce=t(39771),le=t(31001),ue=t(67489),de=t(94671);function pe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function xe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?pe(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var me,ve=function(e){var r=e.amountToSwap,t=e.amountToReceive,n=e.isWrongNetwork,a=e.sx,c=e.poolReserve,l=e.targetReserve,p=e.isMaxSelected,x=e.loading,m=e.blocked,v=e.buildTxFn,h=e.currentRateMode,y=(0,X.Yh)((function(e){return[e.getCreditDelegationApprovedAmount,e.currentMarketData,e.generateApproveDelegation,e.estimateGasLimit,e.addTransaction,e.debtSwitch,e.walletApprovalMethodPreference,e.generateCreditDelegationSignatureRequest]})),b=(0,u.Z)(y,8),f=b[0],g=b[1],j=b[2],w=b[3],S=b[4],A=b[5],T=b[6],D=b[7],O=(0,i.vR)(),k=O.approvalTxState,P=O.mainTxState,Z=O.loadingTxns,C=O.setMainTxState,I=O.setTxError,E=O.setGasLimit,R=O.setLoadingTxns,M=O.setApprovalTxState,F=(0,z.Z)(),N=F.sendTx,Y=F.signTxData,U=(0,ae.n)(),G=U.refetchPoolData,L=U.refetchIncentiveData,H=U.refetchGhoData,V=(0,s.useState)(!1),Q=V[0],K=V[1],$=(0,s.useState)(),J=$[0],ee=$[1],re=(0,s.useState)(!1),pe=re[0],me=re[1],ve=(0,s.useState)(),he=ve[0],ye=ve[1],be=g.v3;(0,s.useEffect)((function(){var e=T===ie.n.PERMIT;me(e)}),[T]);var fe=function(){var e=(0,W.Z)(_().mark((function e(){var r,n,o,s,a,i,c,u,p;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Q||!J){e.next=29;break}if(r=(0,q.sm)(t,l.decimals,.25),!pe||!be){e.next=15;break}return o=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,D({underlyingAsset:l.variableDebtTokenAddress,deadline:o,amount:r,spender:null!==(n=g.addresses.DEBT_SWITCH_ADAPTER)&&void 0!==n?n:""});case 7:return s=e.sent,e.next=10,Y(s);case 10:a=e.sent,ye({signature:a,deadline:o,amount:r}),M({txHash:se.Z,loading:!1,success:!0}),e.next=29;break;case 15:return c=j({debtTokenAddress:l.variableDebtTokenAddress,delegatee:null!==(i=g.addresses.DEBT_SWITCH_ADAPTER)&&void 0!==i?i:"",amount:r}),M(xe(xe({},k),{},{loading:!0})),e.next=19,w(c);case 19:return c=e.sent,e.next=22,N(c);case 22:return u=e.sent,e.next=25,u.wait(1);case 25:M({txHash:u.hash,loading:!1,success:!0}),S(u.hash,{action:d.UQ.approval,txState:"success",asset:l.variableDebtTokenAddress,amount:r,assetName:"varDebt"+l.name,spender:g.addresses.DEBT_SWITCH_ADAPTER}),I(void 0),je(!0);case 29:e.next=36;break;case 31:e.prev=31,e.t0=e.catch(0),p=(0,ce.WG)(e.t0,ce.aD.GAS_ESTIMATION,!1),I(p),k.success||M({txHash:void 0,loading:!1});case 36:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=(0,W.Z)(_().mark((function e(){var r,t,o,s;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(xe(xe({},P),{},{loading:!0})),e.next=4,v();case 4:return r=e.sent,t=A({poolReserve:c,targetReserve:l,currentRateMode:h,amountToReceive:(0,ne.parseUnits)(r.inputAmount,l.decimals).toString(),amountToSwap:(0,ne.parseUnits)(r.outputAmount,c.decimals).toString(),isMaxSelected:p,txCalldata:r.swapCallData,augustus:r.augustus,signatureParams:he,isWrongNetwork:n}),e.next=8,w(t);case 8:return t=e.sent,e.next=11,N(t);case 11:return o=e.sent,e.next=14,o.wait(1);case 14:C({txHash:o.hash,loading:!1,success:!0}),S(o.hash,{action:"debtSwitch",txState:"success",previousState:r.outputAmount+(2===h?" variable"+c.symbol:" stable"+c.symbol),newState:r.inputAmount+" variable"+l.symbol}),oe.queryClient.invalidateQueries({queryKey:le.B.pool}),H&&H(),G&&G(),L&&L(),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(0),s=(0,ce.WG)(e.t0,ce.aD.GAS_ESTIMATION,!1),I(s),C({txHash:void 0,loading:!1});case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(){return e.apply(this,arguments)}}(),je=(0,s.useCallback)(function(){var e=(0,W.Z)(_().mark((function e(r){var n,o,s;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=J)&&!r){e.next=9;break}return R(!0),e.next=5,f({debtTokenAddress:l.variableDebtTokenAddress,delegatee:null!==(o=g.addresses.DEBT_SWITCH_ADAPTER)&&void 0!==o?o:""});case 5:n=e.sent,ee(n),e.next=11;break;case 9:K(!1),M({});case 11:n&&(s=(0,de.iv)({approvedAmount:n.amount,amount:t,signedAmount:"0"}),K(s),s&&M({})),R(!1);case 13:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[J,R,f,l.variableDebtTokenAddress,g.addresses.DEBT_SWITCH_ADAPTER,M,t]);return(0,s.useEffect)((function(){"0"!==r&&(J?J.debtTokenAddress!==l.variableDebtTokenAddress&&je(!0):je())}),[r,J,je,l.variableDebtTokenAddress]),(0,s.useEffect)((function(){var e=0;e=Number(te.eB[d.UQ.borrow].recommended),Q&&!k.success&&(e+=Number(de.Fi)),E(e.toString())}),[Q,k,E]),(0,B.jsx)(ue.B,{mainTxState:P,approvalTxState:k,isWrongNetwork:n,preparingTransactions:Z,handleAction:ge,requiresAmount:!0,amount:r,handleApproval:function(){return fe()},requiresApproval:Q,actionText:(0,B.jsx)(o.cC,{id:"Switch"}),actionInProgressText:(0,B.jsx)(o.cC,{id:"Switching"}),sx:a,fetchingData:x,errorParams:{loading:!1,disabled:m||!(null!==k&&void 0!==k&&k.success),content:(0,B.jsx)(o.cC,{id:"Switch"}),handleClick:ge},blocked:m,tryPermit:be})},he=t(91655),ye=t(75437),be=t(92391),fe=t(58527),ge=(0,B.jsx)(b.Z,{color:"primary",sx:{fontSize:"14px",mx:1},children:(0,B.jsx)(v.Z,{})}),je=function(e){var r,t,n=e.switchSource,s=e.switchTarget,a=e.toAmount,i=e.fromAmount,c=e.loading,l=e.sourceBalance,u=e.sourceBorrowAPY,d=e.targetBorrowAPY,x=e.showAPYTypeChange,m=e.ghoData,g=e.currentMarket,j=(0,p.hE)(l).minus((0,p.hE)(i)),w=(0,p.hE)(s.variableBorrows).plus((0,p.hE)(a)),S=(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(he.Z,{variant:"rectangular",height:20,width:100,sx:{borderRadius:"4px"}}),(0,B.jsx)(he.Z,{variant:"rectangular",height:15,width:80,sx:{borderRadius:"4px",marginTop:"4px"}})]}),A=0,T=null===m||void 0===m?void 0:m.ghoApyRange;return"GHO"===s.reserve.symbol&&m&&(A=(0,$.li)(m.ghoVariableBorrowApy,m.userCurrentBorrowBalance+m.inputAmount,m.userGhoAvailableToBorrowAtDiscount,m.ghoBorrowAPYWithMaxDiscount),T&&(T=[T[0],A])),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(be.X,{caption:(0,B.jsx)(o.cC,{id:"Borrow apy"}),captionVariant:"description",mb:4,children:(0,B.jsx)(f.Z,{sx:{display:"flex",alignItems:"center"},children:c?(0,B.jsx)(he.Z,{variant:"rectangular",height:20,width:100,sx:{borderRadius:"4px"}}):(0,B.jsxs)(B.Fragment,{children:["GHO"===n.reserve.symbol&&m?(0,B.jsx)(R.B,{useApyRange:!1,rangeValues:m.ghoApyRange,variant:"main14",color:"text.secondary",value:m.userCurrentBorrowApy,"data-cy":"apyType",stkAaveBalance:m.userDiscountTokenBalance,ghoRoute:N.Z6.reserveOverview(null!==(r=n.underlyingAsset)&&void 0!==r?r:"",g)+"/#discount",forceShowTooltip:!0,withTokenIcon:m.qualifiesForDiscount,userQualifiesForDiscount:m.qualifiesForDiscount}):(0,B.jsx)(F.B,{value:u,variant:"secondary14",percent:!0}),ge,"GHO"===s.reserve.symbol&&m?(0,B.jsx)(R.B,{useApyRange:m.qualifiesForDiscount&&!m.inputAmount,rangeValues:0===m.inputAmount?m.ghoApyRange:T,variant:"main14",color:"text.secondary",value:0===m.inputAmount?m.userBorrowApyAfterMaxSwitch:A,"data-cy":"apyType",stkAaveBalance:m.userDiscountTokenBalance,ghoRoute:N.Z6.reserveOverview(null!==(t=s.underlyingAsset)&&void 0!==t?t:"",g)+"/#discount",forceShowTooltip:!0,withTokenIcon:m.qualifiesForDiscount,userQualifiesForDiscount:m.qualifiesForDiscount}):(0,B.jsx)(F.B,{value:d,variant:"secondary14",percent:!0})]})})}),x&&(0,B.jsx)(be.X,{caption:(0,B.jsxs)(h.Z,{direction:"row",children:[(0,B.jsx)(o.cC,{id:"APY type"}),(0,B.jsx)(fe.G,{children:(0,B.jsx)(o.cC,{id:"You can only switch to tokens with variable APY types. After this transaction, you may change the variable rate to a stable one if available."})})]}),captionVariant:"description",mb:4,children:(0,B.jsx)(f.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end"},children:c?(0,B.jsx)(he.Z,{variant:"rectangular",height:20,width:100,sx:{borderRadius:"4px"}}):(0,B.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center"},children:["GHO"===n.reserve.symbol?(0,B.jsx)(ye.n,{text:(0,B.jsx)(o.cC,{id:"Fixed"}),typography:"secondary14"}):(0,B.jsx)(y.Z,{variant:"secondary14",children:(0,B.jsx)(o.cC,{id:"Stable"})}),(0,B.jsx)(b.Z,{color:"primary",sx:{fontSize:"14px",mx:1},children:(0,B.jsx)(v.Z,{})}),"GHO"===s.reserve.symbol?(0,B.jsx)(ye.n,{text:(0,B.jsx)(o.cC,{id:"Fixed"}),typography:"secondary14"}):(0,B.jsx)(y.Z,{variant:"secondary14",children:(0,B.jsx)(o.cC,{id:"Variable"})})]})})}),(0,B.jsx)(L.aE,{incentives:n.reserve.aIncentivesData,symbol:n.reserve.symbol,futureIncentives:n.reserve.aIncentivesData,futureSymbol:n.reserve.symbol,loading:c}),(0,B.jsx)(be.X,{caption:(0,B.jsx)(o.cC,{id:"Borrow balance after switch"}),captionVariant:"description",mb:4,align:"flex-start",children:(0,B.jsxs)(f.Z,{sx:{textAlign:"right"},children:[(0,B.jsx)(f.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:c?S:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,B.jsx)(Y.T1,{symbol:n.reserve.iconSymbol,sx:{mr:2,ml:4,fontSize:"16px"}}),(0,B.jsx)(F.B,{value:j.toString(),variant:"secondary14",compact:!0})]}),(0,B.jsx)(F.B,{value:j.multipliedBy((0,p.hE)(n.reserve.priceInUSD)).toString(),variant:"helperText",compact:!0,symbol:"USD",symbolsColor:"text.secondary",color:"text.secondary"})]})}),(0,B.jsx)(f.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},mt:2,children:c?S:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,B.jsx)(Y.T1,{symbol:s.reserve.iconSymbol,sx:{mr:2,ml:4,fontSize:"16px"}}),(0,B.jsx)(F.B,{value:w.toString(),variant:"secondary14",compact:!0})]}),(0,B.jsx)(F.B,{value:w.multipliedBy((0,p.hE)(s.reserve.priceInUSD)).toString(),variant:"helperText",compact:!0,symbol:"USD",symbolsColor:"text.secondary",color:"text.secondary"})]})})]})})]})};function we(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Se(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?we(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):we(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e[e.INSUFFICIENT_LIQUIDITY=0]="INSUFFICIENT_LIQUIDITY"}(me||(me={}));var Ae=function(e){var r=e.poolReserve,t=e.userReserve,n=e.isWrongNetwork,a=e.currentRateMode,c=(0,J.HT)(),g=c.reserves,j=c.user,w=c.ghoReserveData,S=c.ghoUserData,A=(0,V.f)(),T=A.currentChainId,D=A.currentNetworkConfig,O=(0,z.Z)().currentAccount,k=(0,i.vR)(),P=k.gasLimit,Z=k.mainTxState,C=k.txError,I=k.setTxError,R=(0,X.Yh)((function(e){return[e.displayGho,e.currentMarket,e.ghoUserDataFetched,e.ghoUserQualifiesForDiscount]})),N=(0,u.Z)(R,4),H=N[0],te=N[1],ne=N[2],oe=N[3],se=g.filter((function(e){return e.underlyingAsset!==r.underlyingAsset&&"0"!==e.availableLiquidity&&(0,K.hF)(e,j)})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol,variableApy:e.variableBorrowAPY,priceInUsd:e.priceInUSD}}));se=[].concat((0,l.Z)(se.filter((function(e){return"GHO"===e.symbol}))),(0,l.Z)(se.filter((function(e){return"GHO"!==e.symbol}))));var ae=(0,s.useState)(""),ie=ae[0],ce=ae[1],le=(0,s.useRef)(""),ue=(0,s.useState)(se[0]),de=ue[0],pe=ue[1],xe=(0,s.useState)("0.1"),he=xe[0],ye=xe[1],be=j.userReservesData.find((function(e){return e.underlyingAsset===de.address})),fe=a===d.tk.Variable?t.variableBorrows:t.stableBorrows,ge="-1"===ie,we=ge?fe:ie,Ae=function(e){var r=e.chainId,t=e.max,n=e.maxSlippage,o=e.skip,a=e.swapIn,i=e.swapOut,c=e.userAddress,l=(0,s.useState)("0"),u=l[0],d=l[1],x=(0,s.useState)("0"),m=x[0],v=x[1],h=(0,s.useState)("0"),y=h[0],b=h[1],f=(0,s.useState)("0"),g=f[0],j=f[1],w=(0,s.useState)(),S=w[0],A=w[1],T=(0,s.useState)(!1),D=T[0],O=T[1],k=(0,s.useState)(""),B=k[0],P=k[1],Z=(0,s.useMemo)((function(){return{underlyingAsset:a.underlyingAsset,decimals:a.decimals,supplyAPY:a.supplyAPY,amount:a.amount,variableBorrowAPY:a.variableBorrowAPY}}),[a.amount,a.decimals,a.supplyAPY,a.underlyingAsset,a.variableBorrowAPY]),C=(0,s.useMemo)((function(){return{underlyingAsset:i.underlyingAsset,decimals:i.decimals,supplyAPY:i.supplyAPY,amount:i.amount,variableBorrowAPY:i.variableBorrowAPY}}),[i.amount,i.decimals,i.supplyAPY,i.underlyingAsset,i.variableBorrowAPY]),I=(0,s.useCallback)((function(){return(0,q.wP)(Z,C,r,c,t)}),[r,t,Z,C,c]);return(0,s.useEffect)((function(){if(!o){var e=function(){var e=(0,W.Z)(_().mark((function e(){var r,t,o;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z.underlyingAsset&&C.underlyingAsset&&C.amount&&"0"!==C.amount&&!isNaN(+C.amount)){e.next=7;break}return d("0"),v("0"),b("0"),j("0"),A(void 0),e.abrupt("return");case 7:return O(!0),e.prev=8,e.next=11,I();case 11:r=e.sent,P(""),A(r),t=new p.rh(r.srcAmount).multipliedBy(1+n/100).toFixed(0),d((0,p.Fv)(t,r.srcDecimals)),b((0,p.Fv)(r.destAmount,r.destDecimals)),v(r.srcUSD),j(r.destUSD),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(8),console.error(e.t0),o=(0,q.aE)(e.t0.message),P(o);case 26:return e.prev=26,O(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[8,21,26,29]])})));return function(){return e.apply(this,arguments)}}(),r=setTimeout((function(){e()}),400);return function(){clearTimeout(r)}}}),[o,Z.underlyingAsset,Z.amount,C.underlyingAsset,C.amount,I,n]),{outputAmount:y,outputAmountUSD:g,inputAmount:u,inputAmountUSD:m,loading:D,error:B,buildTxFn:function(){var e=(0,W.Z)(_().mark((function e(){return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=2;break}throw new Error("Route required to build transaction");case 2:return e.abrupt("return",(0,q._n)(S,a,i,r,c,n));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}({chainId:D.underlyingChainId||T,userAddress:O,swapOut:Se(Se({},r),{},{amount:le.current}),swapIn:Se(Se({},be.reserve),{},{amount:"0"}),max:ge,skip:Z.loading||!1,maxSlippage:Number(he)}),ke=Ae.inputAmount,Be=Ae.outputAmount,Pe=Ae.outputAmountUSD,Ze=Ae.error,Ce=Ae.loading,Ie=Ae.buildTxFn,Ee=Ce&&"0"===Pe,Re=(0,p.hE)(x.Bz.toString()),Me="0";H({symbol:be.reserve.symbol,currentMarket:te})?Me=w.aaveFacilitatorRemainingCapacity.toString():(Re="0"===be.reserve.borrowCap?(0,p.hE)(x.Bz.toString()):(0,p.hE)(Number(be.reserve.borrowCap)).minus((0,p.hE)(be.reserve.totalDebt)),Me=be.reserve.formattedAvailableLiquidity);var Fe=E.Z.max(E.Z.min(Me,Re),0),Ne=Number(we)*Number(r.priceInUSD),Ye=Number(ke)*Number(de.priceInUsd),Ue=Ye-Ne,Ge=0===Number(j.availableBorrowsUSD)||Ue>Number(j.availableBorrowsUSD),Le=void 0;(0,E.Z)(ke).gt(Fe)&&(Le=me.INSUFFICIENT_LIQUIDITY);var We=function(){return Le===me.INSUFFICIENT_LIQUIDITY?(0,B.jsx)(o.cC,{id:"There is not enough liquidity for the target asset to perform the switch. Try lowering the amount."}):null};if(Z.success)return(0,B.jsx)(ee.R,{customAction:(0,B.jsxs)(h.Z,{gap:3,children:[(0,B.jsx)(y.Z,{variant:"description",color:"text.primary",children:(0,B.jsx)(o.cC,{id:"You've successfully switched borrow position."})}),(0,B.jsxs)(h.Z,{direction:"row",alignItems:"center",justifyContent:"center",gap:1,children:[(0,B.jsx)(Y.T1,{symbol:r.iconSymbol,sx:{mx:1}}),(0,B.jsx)(F.B,{value:le.current,compact:!0,variant:"subheader1"}),r.symbol,(0,B.jsx)(b.Z,{color:"primary",sx:{fontSize:"14px",mx:1},children:(0,B.jsx)(v.Z,{})}),(0,B.jsx)(Y.T1,{symbol:be.reserve.iconSymbol,sx:{mx:1}}),(0,B.jsx)(F.B,{value:ke,compact:!0,variant:"subheader1"}),be.reserve.symbol]})]})});var He,_e=!1;if(g.some((function(e){return"GHO"===e.symbol}))){var qe=Number(fe)*Number(r.priceInUSD)+S.userGhoBorrowBalance,Ve=(0,$.li)(w.ghoVariableBorrowAPY,S.userGhoBorrowBalance,S.userGhoAvailableToBorrowAtDiscount,w.ghoBorrowAPYWithMaxDiscount),ze=(0,$.li)(w.ghoVariableBorrowAPY,qe,S.userGhoAvailableToBorrowAtDiscount,w.ghoBorrowAPYWithMaxDiscount),Qe=ne?[Ve,ze]:void 0;_e=oe(fe),He={qualifiesForDiscount:_e,ghoApyRange:Qe,userBorrowApyAfterMaxSwitch:ze,userDiscountTokenBalance:S.userDiscountTokenBalance,inputAmount:Number(we),targetAmount:Number(ke),userCurrentBorrowApy:Ve,ghoVariableBorrowApy:w.ghoVariableBorrowAPY,userGhoAvailableToBorrowAtDiscount:S.userGhoAvailableToBorrowAtDiscount,ghoBorrowAPYWithMaxDiscount:w.ghoBorrowAPYWithMaxDiscount,userCurrentBorrowBalance:S.userGhoBorrowBalance}}return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(G.W,{value:we,onChange:function(e){var r="-1"===e;le.current=r?fe:e,ce(e),I(void 0)},usdValue:Ne.toString(),symbol:r.symbol,assets:[{balance:fe,address:r.underlyingAsset,symbol:r.symbol,iconSymbol:r.iconSymbol}],maxValue:fe,inputTitle:(0,B.jsx)(o.cC,{id:"Borrowed asset amount"}),balanceText:(0,B.jsx)(s.Fragment,{children:(0,B.jsx)(o.cC,{id:"Borrow balance"})}),isMaxSelected:ge}),(0,B.jsxs)(f.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,B.jsx)(b.Z,{sx:{fontSize:"18px !important"},children:(0,B.jsx)(m.Z,{})}),(0,B.jsx)(M.B,{loading:Ee,outputAmountUSD:Ye.toString(),inputAmountUSD:Ne.toString()})]}),(0,B.jsx)(G.W,{value:ke,onSelect:pe,usdValue:Ye.toString(),symbol:de.symbol,assets:se,inputTitle:(0,B.jsx)(o.cC,{id:"Switch to"}),balanceText:(0,B.jsx)(o.cC,{id:"Supply balance"}),disableInput:!0,loading:Ee,selectOptionHeader:(0,B.jsx)(Te,{}),selectOption:function(e){var r,t;return"GHO"===e.symbol?(0,B.jsx)(Oe,{asset:e,ghoApyRange:null===(r=He)||void 0===r?void 0:r.ghoApyRange,userBorrowApyAfterMaxSwitch:null===(t=He)||void 0===t?void 0:t.userBorrowApyAfterMaxSwitch,userDiscountTokenBalance:S.userDiscountTokenBalance,currentMarket:te,qualifiesForDiscount:_e}):(0,B.jsx)(De,{asset:e})}}),Ze&&!Ee&&(0,B.jsx)(y.Z,{variant:"helperText",color:"error.main",children:Ze}),!Ze&&void 0!==Le&&(0,B.jsx)(y.Z,{variant:"helperText",color:"error.main",children:(0,B.jsx)(We,{})}),(0,B.jsx)(L.m6,{gasLimit:P,slippageSelector:(0,B.jsx)(Q.n,{selectedSlippage:he,setSlippage:function(e){I(void 0),ye(e)}}),children:(0,B.jsx)(je,{switchSource:t,switchTarget:be,toAmount:ke,fromAmount:""===we?"0":we,loading:Ee,sourceBalance:fe,sourceBorrowAPY:a===d.tk.Variable?r.variableBorrowAPY:r.stableBorrowAPY,targetBorrowAPY:be.reserve.variableBorrowAPY,showAPYTypeChange:a===d.tk.Stable||"GHO"===t.reserve.symbol||"GHO"===be.reserve.symbol,ghoData:He,currentMarket:te})}),C&&(0,B.jsx)(re.f,{txError:C}),Ge&&(0,B.jsx)(U.v,{severity:"error",sx:{mt:4},children:(0,B.jsx)(y.Z,{variant:"caption",children:(0,B.jsx)(o.cC,{id:"Insufficient collateral to cover new borrow position. Wallet must have borrowing power remaining to perform debt switch."})})}),(0,B.jsx)(ve,{isMaxSelected:ge,poolReserve:r,amountToSwap:Be,amountToReceive:ke,isWrongNetwork:n,targetReserve:be.reserve,symbol:r.symbol,blocked:void 0!==Le||""!==Ze||Ge,loading:Ce,buildTxFn:Ie,currentRateMode:a===d.tk.Variable?2:1})]})},Te=function(){return(0,B.jsx)(C,{sx:function(e){return{borderBottom:"1px solid ".concat(e.palette.divider),mt:-1}},children:(0,B.jsxs)(h.Z,{direction:"row",sx:{py:4},gap:14,children:[(0,B.jsx)(y.Z,{variant:"subheader2",children:(0,B.jsx)(o.cC,{id:"Select an asset"})}),(0,B.jsx)(y.Z,{variant:"subheader2",children:(0,B.jsx)(o.cC,{id:"Borrow APY"})})]})})},De=function(e){var r=e.asset;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Y.T1,{aToken:r.aToken,symbol:r.iconSymbol||r.symbol,sx:{fontSize:"22px",mr:1}}),(0,B.jsx)(I.Z,{sx:{mr:6},children:r.symbol}),(0,B.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"end"},children:[(0,B.jsx)(F.B,{value:r.variableApy,percent:!0,variant:"main14",color:"text.secondary"}),(0,B.jsx)(y.Z,{variant:"helperText",color:"text.secondary",children:(0,B.jsx)(o.cC,{id:"Variable rate"})})]})]})},Oe=function(e){var r,t=e.ghoApyRange,n=e.asset,s=e.userBorrowApyAfterMaxSwitch,a=e.userDiscountTokenBalance,i=e.currentMarket,c=e.qualifiesForDiscount;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Y.T1,{aToken:n.aToken,symbol:n.iconSymbol||n.symbol,sx:{fontSize:"22px",mr:1}}),(0,B.jsx)(I.Z,{sx:{mr:6},children:n.symbol}),(0,B.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"end"},children:[(0,B.jsx)(R.B,{useApyRange:c,rangeValues:t,variant:"main14",color:"text.secondary",value:null!==s&&void 0!==s?s:-1,"data-cy":"apyType",stkAaveBalance:a,ghoRoute:N.Z6.reserveOverview(null!==(r=null===n||void 0===n?void 0:n.address)&&void 0!==r?r:"",i)+"/#discount",forceShowTooltip:!0,withTokenIcon:c,userQualifiesForDiscount:c}),(0,B.jsx)(y.Z,{variant:"helperText",color:"text.secondary",children:(0,B.jsx)(o.cC,{id:"Fixed rate"})})]})]})};function ke(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Be(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ke(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ke(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var Pe=function(){var e=(0,i.vR)(),r=e.type,t=e.close,n=e.args;return(0,B.jsx)(a.P,{open:r===i.w8.DebtSwitch,setOpen:t,children:(0,B.jsx)(c.A,{title:(0,B.jsx)(o.cC,{id:"Switch borrow position"}),underlyingAsset:n.underlyingAsset,hideTitleSymbol:!0,children:function(e){return(0,B.jsx)(Ae,Be(Be({},e),{},{currentRateMode:n.currentRateMode}))}})})}},94635:function(e,r,t){t.d(r,{A:function(){return b}});var n=t(80854),o=(t(67294),t(34220)),s=t(80664),a=t(43629),i=t(66209),c=t(8195),l=t(22454),u=t(77537),d=t(8656),p=t(63206),x=t(57609),m=t(78944),v=t(10343),h=t(63491),y=t(85893),b=function(e){var r,t,b=e.hideTitleSymbol,f=e.underlyingAsset,g=e.children,j=e.requiredChainId,w=e.title,S=e.requiredPermission,A=e.keepWrappedSymbol,T=(0,u.Z)().readOnlyModeAddress,D=(0,d.Yh)((function(e){return e.currentMarketData})),O=(0,d.Yh)((function(e){return e.currentNetworkConfig})),k=(0,s.P)(D).walletBalances,B=(0,o.HT)(),P=B.user,Z=B.reserves,C=(0,c.vR)(),I=C.txError,E=C.mainTxState,R=(0,l.T)().permissions,M=(0,i.Q)(j),F=M.isWrongNetwork,N=M.requiredChainId;if(I&&I.blocking)return(0,y.jsx)(h.D,{txError:I});if(S&&p.cr.permissions(D)&&!R.includes(S)&&D.permissionComponent)return(0,y.jsx)(y.Fragment,{children:D.permissionComponent});var Y=Z.find((function(e){return f.toLowerCase()===n.hP.toLowerCase()?e.isWrappedBaseAsset:f===e.underlyingAsset})),U=null===P||void 0===P?void 0:P.userReservesData.find((function(e){return f.toLowerCase()===n.hP.toLowerCase()?e.reserve.isWrappedBaseAsset:f===e.underlyingAsset})),G=Y.isWrappedBaseAsset&&!A?O.baseAssetSymbol:Y.symbol;return(0,y.jsxs)(a.hv,{asset:Y,children:[!E.success&&(0,y.jsx)(m.E,{title:w,symbol:b?void 0:G}),F&&!T&&(0,y.jsx)(v.I,{networkName:(0,p.Mo)(N).name,chainId:N,event:{eventName:x.vh.SWITCH_NETWORK,eventParams:{asset:f}}}),g({isWrongNetwork:F,nativeBalance:(null===(r=k[n.hP.toLowerCase()])||void 0===r?void 0:r.amount)||"0",tokenBalance:(null===(t=k[Y.underlyingAsset.toLowerCase()])||void 0===t?void 0:t.amount)||"0",poolReserve:Y,symbol:G,underlyingAsset:f,userReserve:U})]})}},99730:function(e,r,t){t.d(r,{f:function(){return l}});var n=t(49501),o=t(30120),s=t(29630),a=t(69331),i=t(67916),c=t(85893),l=function(e){var r=e.txError;return(0,c.jsxs)(o.Z,{children:[(0,c.jsx)(i.Q,{txError:r}),"MetaMask Message Signature: User denied message signature."!==r.rawError.message&&"MetaMask Tx Signature: User denied transaction signature."!==r.rawError.message&&(0,c.jsx)(o.Z,{sx:{pt:4},children:(0,c.jsx)(a.v,{severity:"info",children:(0,c.jsxs)(s.Z,{variant:"description",children:[" ",(0,c.jsx)(n.cC,{id:"Tip: Try increasing slippage or reduce input amount"})]})})})]})}},20301:function(e,r,t){t.d(r,{n:function(){return P}});var n=t(17674),o=t(49501),s=t(10822),a=t(61782),i=t(64343),c=t(75084),l=t(30120),u=t(29630),d=t(81645),p=t(73812),x=t(31538),m=t(61702),v=t(29894),h=t(44373),y=t(67294),b=t(59499),f=t(36864),g=t(57609),j=t(58527),w=t(85893);function S(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function A(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?S(Object(t),!0).forEach((function(r){(0,b.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var T,D=function(e){var r=(0,f.Z)({},e);return(0,w.jsx)(j.G,A(A({event:{eventName:g.vh.TOOL_TIP,eventParams:{tooltip:"Slippage Tollerance"}}},r),{},{children:(0,w.jsx)(o.cC,{id:"Slippage is the difference between the quoted and received amounts from changing market conditions between the moment the transaction is submitted and its verification."})}))},O=t(8656);function k(){return k=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},k.apply(this,arguments)}var B=function(e){return y.createElement("svg",k({width:15,height:12,viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),T||(T=y.createElement("path",{d:"M14.948 12 8.035 0 1.12 12h13.827ZM3.176 5.625 6.353 0H0l3.176 5.625Zm8.949 4.787h-8.18l4.09-7.1 4.09 7.1Z",fill:"#2669F5"})))},P=function(e){var r=e.setSlippage,t=e.selectedSlippage,b=y.useState(null),f=(0,n.Z)(b,2),j=f[0],S=f[1],A=Boolean(j),T=(0,O.Yh)((function(e){return e.trackEvent})),k=function(){S(null)};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.Z,{variant:"text",onClick:function(e){S(e.currentTarget)},size:"medium",endIcon:(0,w.jsx)(D,{text:(0,w.jsx)(l.Z,{sx:{display:"flex",alignItems:"center"},children:(0,w.jsx)(o.cC,{id:"<0>Slippage tolerance </0><1>{selectedSlippage}% </1><2>{0}</2>",values:{0:A?(0,w.jsx)(s.Z,{}):(0,w.jsx)(a.Z,{}),selectedSlippage:t},components:{0:(0,w.jsx)(u.Z,{color:"text.secondary",variant:"description"}),1:(0,w.jsx)(u.Z,{color:"text.main",variant:"secondary14",sx:{px:"4px"}}),2:(0,w.jsx)(d.Z,{sx:{fontSize:"14px !important",mr:"4px"}})}})}),variant:"secondary14"}),disabled:!1,"data-cy":"slippageButton_".concat(t)}),(0,w.jsxs)(p.Z,{anchorEl:j,open:A,onClose:k,MenuListProps:{"aria-labelledby":"basic-button"},keepMounted:!0,"data-cy":"slippageMenu_".concat(t),children:[(0,w.jsx)(l.Z,{sx:{px:"16px",py:"12px"},children:(0,w.jsx)(u.Z,{variant:"secondary12",color:"text.secondary",children:(0,w.jsx)(o.cC,{id:"Select slippage tolerance"})})}),["0.1","0.5","1"].map((function(e){var n=e===t;return(0,w.jsxs)(x.Z,{selected:n,value:e,onClick:function(){r(e),T(g.vh.SET_SLIPPAGE,{amount:e}),k()},children:[(0,w.jsxs)(m.Z,{primaryTypographyProps:{variant:"subheader1"},children:[e,"%"]}),(0,w.jsx)(v.Z,{children:(0,w.jsx)(d.Z,{children:n&&(0,w.jsx)(i.Z,{})})})]},e)})),(0,w.jsx)(h.Z,{}),(0,w.jsxs)(l.Z,{sx:{px:"16px",py:"12px",display:"inline-flex",alignItems:"center"},children:[(0,w.jsxs)(u.Z,{variant:"secondary12",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[(0,w.jsx)(o.cC,{id:"Powered by"}),(0,w.jsx)(d.Z,{sx:{fontSize:"20px",width:"20px",color:"#2669F5",position:"relative",top:"5px",left:"5px"},children:(0,w.jsx)(B,{})})]}),(0,w.jsx)(u.Z,{variant:"main12",color:"text.secondary",children:"Paraswap"})]})]})]})}},52358:function(e,r,t){var n=t(67294);const o=n.forwardRef((function(e,r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 14l-7 7m0 0l-7-7m7 7V3"}))}));r.Z=o},10822:function(e,r,t){var n=t(67294);const o=n.forwardRef((function(e,r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"}))}));r.Z=o}}]);