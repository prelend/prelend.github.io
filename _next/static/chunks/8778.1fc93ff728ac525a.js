"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8778],{34637:function(e,t,r){r.d(t,{Y:function(){return d},Z:function(){return p}});var n=r(59499),s=r(81719),a=r(87054),o=(r(67294),r(85893));function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=(0,s.ZP)(a.Z)((function(e){var t=e.theme;return{border:"0px",flex:1,backgroundColor:"#383D51",borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",".MuiTypography-subheader1":{background:t.palette.gradients.aaveGradient,backgroundClip:"text",textFillColor:"transparent"},".MuiTypography-secondary14":{background:t.palette.gradients.aaveGradient,backgroundClip:"text",textFillColor:"transparent"}}}})),l=(0,s.ZP)(a.Z)((function(e){var t=e.theme;return{border:"0px",flex:1,color:t.palette.text.muted,borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{border:"1px solid ".concat(t.palette.other.standardInputLine),backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",color:t.palette.background.header}}}));function d(e){return(0,o.jsx)(l,c({},e))}function p(e){return(0,o.jsx)(u,c({},e))}},59379:function(e,t,r){r.d(t,{f:function(){return d},Z:function(){return p}});var n=r(59499),s=r(81719),a=r(85390),o=r(85893);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=(0,s.ZP)(a.Z)({backgroundColor:"#383D51",border:"1px solid rgba(235, 235, 237, 0.12)",padding:"4px"}),l=(0,s.ZP)(a.Z)((function(e){return{backgroundColor:e.theme.palette.background.header,padding:"2px",height:"36px",width:"100%"}}));function d(e){return(0,o.jsx)(l,c({},e))}function p(e){return(0,o.jsx)(u,c({},e))}},28778:function(e,t,r){r.r(t),r.d(t,{WithdrawModal:function(){return we}});var n=r(59499),s=r(49501),a=r(23286),o=r(67294),i=r(34220),c=r(8195),u=r(46930),l=r(69125),d=r(63206),p=r(31959),h=r(94635),x=r(90116),m=r(1279),b=r(55929),f=r(30120),v=r(81645),g=r(29630),y=r(75158),T=r(25935),w=r(69331),O=r(30313),A=r(77537),j=r(20301),S=r(8656),W=r(68448),_=r(57609),I=r(53601),D=r(67916),C=r(57824),E=r(94671),R=r(70794),k=function(e,t,r){var n=(0,m.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),s=(0,m.hE)(r.unborrowedLiquidity),a=R.Z.min(n,s),o=(0,m.hE)("0"),i=e.isInEmode&&e.userEmodeCategoryId===r.eModeCategoryId?r.formattedEModeLiquidationThreshold:r.formattedReserveLiquidationThreshold;if(null!==t&&void 0!==t&&t.usageAsCollateralEnabledOnUser&&"0"!==r.reserveLiquidationThreshold&&"0"!==e.totalBorrowsMarketReferenceCurrency){var c=(0,m.hE)(e.healthFactor).minus("1.01");c.gt("0")&&(o=c.multipliedBy(e.totalBorrowsMarketReferenceCurrency).div(i)),a=R.Z.min(a,o.dividedBy(r.formattedPriceInMarketReferenceCurrency))}return a},H=r(50029),P=r(17674),N=r(87794),Z=r.n(N),L=r(75331),U=r(24243),M=r(80854),B=r(56371),F=r(30194),q=r(89291),V=r(19419),G=r(74119),Y=r(32113),Q=r(39771),z=r(31001),K=r(67489),X=r(85893);function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee,te=function(e){var t=e.amountToSwap,r=e.isWrongNetwork,n=e.sx,a=e.poolReserve,i=e.targetReserve,u=e.isMaxSelected,l=e.loading,d=e.blocked,p=e.buildTxFn,h=(0,S.Yh)((function(e){return[e.withdrawAndSwitch,e.currentMarketData,e.jsonRpcProvider,e.account,e.generateApproval,e.estimateGasLimit,e.walletApprovalMethodPreference,e.generateSignatureRequest,e.addTransaction,e.trackEvent]})),x=(0,P.Z)(h,10),m=x[0],b=x[1],f=x[2],v=x[3],g=x[4],y=x[5],T=x[6],w=x[7],O=x[8],j=x[9],W=(0,c.vR)(),I=W.approvalTxState,D=W.mainTxState,C=W.loadingTxns,R=W.setMainTxState,k=W.setTxError,N=W.setGasLimit,J=W.setLoadingTxns,ee=W.setApprovalTxState,te=(0,A.Z)(),re=te.sendTx,ne=te.signTxData,se=(0,o.useState)(void 0),ae=se[0],oe=se[1],ie=(0,o.useState)(),ce=ie[0],ue=ie[1],le=(0,V.n)(),de=le.refetchPoolData,pe=le.refetchIncentiveData,he=le.refetchGhoData,xe=(0,o.useMemo)((function(){return void 0!==ae&&-1!==ae&&"0"!==t&&!r&&ae<=Number(t)}),[ae,t,r]),me=T===Y.n.PERMIT,be=function(){var e=(0,H.Z)(Z().mark((function e(){var t,r,n,s,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,R($($({},D),{},{loading:!0})),e.next=4,p();case 4:return t=e.sent,r=m({poolReserve:a,targetReserve:i,isMaxSelected:u,amountToSwap:(0,B.parseUnits)(t.inputAmount,a.decimals).toString(),amountToReceive:(0,B.parseUnits)(t.outputAmount,i.decimals).toString(),augustus:t.augustus,txCalldata:t.swapCallData,signatureParams:ce}),e.next=8,y(r);case 8:return n=e.sent,e.next=11,re(n);case 11:return s=e.sent,e.next=14,s.wait(1);case 14:F.queryClient.invalidateQueries({queryKey:z.B.pool}),he&&he(),de&&de(),pe&&pe(),R({txHash:s.hash,loading:!1,success:!0}),O(s.hash,{action:L.UQ.withdrawAndSwitch,txState:"success",asset:a.underlyingAsset,amount:(0,B.parseUnits)(t.inputAmount,a.decimals).toString(),assetName:a.name,outAsset:i.underlyingAsset,outAssetName:i.name,outAmount:(0,B.parseUnits)(t.outputAmount,i.decimals).toString()}),e.next=28;break;case 22:e.prev=22,e.t0=e.catch(0),o=(0,Q.WG)(e.t0,Q.aD.GAS_ESTIMATION,!1),k(o),R({txHash:void 0,loading:!1}),j(_.vh.TRANSACTION_ERROR,{transactiontype:L.UQ.withdrawAndSwitch,asset:a.underlyingAsset,assetName:a.name,error:e.t0});case 28:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=(0,H.Z)(Z().mark((function e(){var r,n,s,o,i,c,u,l,d;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,G.sm)(t,a.decimals),n={user:v,token:a.aTokenAddress,spender:b.addresses.WITHDRAW_SWITCH_ADAPTER||"",amount:r},e.prev=2,!me){e.next=16;break}return s=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,w($($({},n),{},{deadline:s}));case 7:return o=e.sent,ee($($({},I),{},{loading:!0})),e.next=11,ne(o);case 11:i=e.sent,ue({signature:i,deadline:s,amount:r}),ee({txHash:q.Z,loading:!1,success:!0}),e.next=30;break;case 16:return c=g(n),e.next=19,y(c);case 19:return u=e.sent,ee($($({},I),{},{loading:!0})),e.next=23,re(u);case 23:return l=e.sent,e.next=26,l.wait(1);case 26:ee({txHash:l.hash,loading:!1,success:!0}),O(l.hash,{action:L.UQ.withdrawAndSwitch,txState:"success",asset:a.aTokenAddress,amount:(0,B.parseUnits)(r,a.decimals).toString(),assetName:"a".concat(a.symbol),spender:b.addresses.WITHDRAW_SWITCH_ADAPTER}),k(void 0),ve(a.aTokenAddress);case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(2),d=(0,Q.WG)(e.t0,Q.aD.GAS_ESTIMATION,!1),k(d),I.success||ee({txHash:void 0,loading:!1});case 37:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}(),ve=(0,o.useCallback)(function(){var e=(0,H.Z)(Z().mark((function e(t){var r,n,s;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),r=f(),n=new U.A(r),e.next=5,n.approvedAmount({user:v,token:t,spender:b.addresses.WITHDRAW_SWITCH_ADAPTER||""});case 5:s=e.sent,oe(s),J(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,v,b.addresses.WITHDRAW_SWITCH_ADAPTER,J]);return(0,o.useEffect)((function(){ve(a.aTokenAddress)}),[ve,a.aTokenAddress]),(0,o.useEffect)((function(){var e=0;e=Number(M.eB[L.UQ.withdrawAndSwitch].recommended),xe&&!I.success&&(e+=Number(E.pQ)),N(e.toString())}),[xe,I,N]),(0,X.jsx)(K.B,{mainTxState:D,approvalTxState:I,isWrongNetwork:r,preparingTransactions:C,handleAction:be,requiresAmount:!0,amount:t,handleApproval:function(){return fe()},requiresApproval:xe,actionText:(0,X.jsx)(s.cC,{id:"Withdraw and Switch"}),actionInProgressText:(0,X.jsx)(s.cC,{id:"Withdrawing and Switching"}),sx:n,errorParams:{loading:!1,disabled:d||!(null!==I&&void 0!==I&&I.success),content:(0,X.jsx)(s.cC,{id:"Withdraw and Switch"}),handleClick:be},fetchingData:l,blocked:d,tryPermit:!0})},re=r(71335),ne=r(41024),se=r(72667),ae=r(55200),oe=function(e){var t=e.txHash,r=e.amount,n=e.symbol,a=e.outAmount,o=e.outSymbol;return(0,X.jsx)(ae.R,{txHash:t,children:(0,X.jsxs)(f.Z,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,X.jsx)(g.Z,{children:(0,X.jsx)(s.cC,{id:"You've successfully withdrew & switched tokens."})}),(0,X.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center",gap:2,mt:3},children:[(0,X.jsx)(se.T1,{sx:{fontSize:"20px"},symbol:n}),(0,X.jsx)(ne.B,{value:Number(r),compact:!0,variant:"main14"}),(0,X.jsx)(g.Z,{variant:"secondary14",children:n}),(0,X.jsx)(v.Z,{sx:{fontSize:"14px"},children:(0,X.jsx)(re.Z,{fontSize:"14px"})}),(0,X.jsx)(se.T1,{sx:{fontSize:"20px"},symbol:o}),(0,X.jsx)(ne.B,{value:Number(a),variant:"main14"}),(0,X.jsx)(g.Z,{variant:"secondary14",children:o})]})]})})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(ee||(ee={}));var ie,ce=function(e){var t,r=e.assetsBlockingWithdraw,a=e.poolReserve,o=e.healthFactorAfterWithdraw,u=e.withdrawAmount,l=(0,c.vR)().mainTxState,d=(0,i.HT)().user,p=void 0,h=(0,m.hE)(a.unborrowedLiquidity);l.success||l.txHash||(r.length>0&&!r.includes(a.symbol)?p=ee.ZERO_LTV_WITHDRAW_BLOCKED:o.lt("1")&&"0"!==d.totalBorrowsMarketReferenceCurrency?p=ee.CAN_NOT_WITHDRAW_THIS_AMOUNT:p||!h.eq("0")&&!(0,m.hE)(u).gt(a.unborrowedLiquidity)||(p=ee.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY));var x=(t={},(0,n.Z)(t,ee.CAN_NOT_WITHDRAW_THIS_AMOUNT,(0,X.jsx)(s.cC,{id:"You can not withdraw this amount because it will cause collateral call"})),(0,n.Z)(t,ee.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY,(0,X.jsx)(s.cC,{id:"These funds have been borrowed and are not available for withdrawal at this time."})),(0,n.Z)(t,ee.ZERO_LTV_WITHDRAW_BLOCKED,(0,X.jsx)(s.cC,{id:"Assets with zero LTV ({assetsBlockingWithdraw}) must be withdrawn or disabled as collateral to perform this action",values:{assetsBlockingWithdraw:r}})),t);return{blockingError:p,errorComponent:p?x[p]:null}};function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(ie||(ie={}));var de,pe=function(e){var t=e.poolReserve,r=e.userReserve,n=e.symbol,a=e.isWrongNetwork,l=(0,c.vR)(),d=l.gasLimit,p=l.mainTxState,h=l.txError,R=(0,A.Z)().currentAccount,H=(0,i.HT)(),P=H.user,N=H.reserves,Z=(0,u.f)(),L=Z.currentNetworkConfig,U=Z.currentChainId,M=(0,o.useState)(""),B=M[0],F=M[1],q=(0,o.useState)(!1),V=q[0],G=q[1],Y=(0,o.useRef)(""),Q=(0,S.Yh)((function(e){return e.trackEvent})),z=(0,o.useState)("0.1"),K=z[0],J=z[1],$=N.filter((function(e){return e.underlyingAsset!==t.underlyingAsset})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol}}));$=[].concat((0,x.Z)($.filter((function(e){return"GHO"===e.symbol}))),(0,x.Z)($.filter((function(e){return"GHO"!==e.symbol}))));var ee=(0,o.useState)($[0]),re=ee[0],ne=ee[1],se="-1"===B,ae=P.userReservesData.find((function(e){return e.underlyingAsset===re.address})),ie=k(P,r,t),ue=(0,m.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),de=(0,O.k)({chainId:L.underlyingChainId||U,userAddress:R,swapIn:le(le({},t),{},{amount:Y.current}),swapOut:le(le({},ae.reserve),{},{amount:"0"}),max:se&&ie.eq(ue),skip:p.loading||!1,maxSlippage:Number(K)}),pe=de.inputAmountUSD,he=de.inputAmount,xe=de.outputAmount,me=de.outputAmountUSD,be=de.error,fe=de.loading,ve=de.buildTxFn,ge=fe&&"0"===me,ye=(0,m.hE)(t.unborrowedLiquidity),Te=(0,E.Vc)(P),we=se?ie.toString(10):B,Oe=(0,W.DX)({user:P,userReserve:r,poolReserve:t,withdrawAmount:we}),Ae=ce({assetsBlockingWithdraw:Te,poolReserve:t,healthFactorAfterWithdraw:Oe,withdrawAmount:we}),je=Ae.blockingError,Se=Ae.errorComponent,We=Oe.toNumber()>=1&&Oe.toNumber()<1.5&&r.usageAsCollateralEnabledOnUser,_e=(0,m.hE)(we).multipliedBy((null===r||void 0===r?void 0:r.reserve.priceInUSD)||0);return p.success?(0,X.jsx)(oe,{txHash:p.txHash,amount:he,symbol:t.isWrappedBaseAsset?L.baseAssetSymbol:t.symbol,outSymbol:re.symbol,outAmount:xe}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(I.W,{inputTitle:(0,X.jsx)(s.cC,{id:"Withdraw"}),value:we,onChange:function(e){var t="-1"===e;Y.current=t?ie.toString(10):e,F(e),t&&ie.eq(ue)&&Q(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"})},symbol:n,assets:[{balance:ie.toString(10),symbol:n,iconSymbol:t.isWrappedBaseAsset?L.baseAssetSymbol:t.iconSymbol}],usdValue:_e.toString(10),isMaxSelected:se,disabled:p.loading,maxValue:ie.toString(10),balanceText:ye.lt(ue)?(0,X.jsx)(s.cC,{id:"Available"}):(0,X.jsx)(s.cC,{id:"Supply balance"})}),(0,X.jsxs)(f.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,X.jsx)(v.Z,{sx:{fontSize:"18px !important"},children:(0,X.jsx)(b.Z,{})}),(0,X.jsx)(T.B,{loading:ge,outputAmountUSD:me,inputAmountUSD:pe})]}),(0,X.jsx)(I.W,{value:xe,onSelect:ne,usdValue:me,symbol:re.symbol,assets:$,inputTitle:(0,X.jsx)(s.cC,{id:"Receive (est.)"}),balanceText:(0,X.jsx)(s.cC,{id:"Supply balance"}),disableInput:!0,loading:ge}),be&&!ge&&(0,X.jsx)(g.Z,{variant:"helperText",color:"error.main",children:be}),void 0!==je&&(0,X.jsx)(g.Z,{variant:"helperText",color:"error.main",children:Se}),(0,X.jsxs)(C.m6,{gasLimit:d,slippageSelector:(0,X.jsx)(j.n,{selectedSlippage:K,setSlippage:J}),children:[(0,X.jsx)(C.oD,{description:(0,X.jsx)(s.cC,{id:"Remaining supply"}),value:ue.minus(we||"0").toString(10),symbol:t.isWrappedBaseAsset?L.baseAssetSymbol:t.symbol}),(0,X.jsx)(C.jz,{visibleHfChange:!!B,healthFactor:P?P.healthFactor:"-1",futureHealthFactor:Oe.toString(10)})]}),h&&(0,X.jsx)(D.Q,{txError:h}),We&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(w.v,{severity:"error",sx:{my:6},children:(0,X.jsx)(s.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,X.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,X.jsx)(y.Z,{checked:V,onChange:function(){G(!V),Q(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:V})},size:"small","data-cy":"risk-checkbox"}),(0,X.jsx)(g.Z,{variant:"description",children:(0,X.jsx)(s.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,X.jsx)(te,{poolReserve:t,targetReserve:ae.reserve,amountToSwap:he,amountToReceive:xe,isMaxSelected:se&&ie.eq(ue),isWrongNetwork:a,blocked:void 0!==je||We&&!V,buildTxFn:ve,sx:We?{mt:0}:{}})]})},he=r(93608),xe=function(e){var t=e.poolReserve,r=e.amountToWithdraw,n=e.poolAddress,a=e.isWrongNetwork,o=e.symbol,i=e.blocked,c=e.sx,u=(0,S.Yh)((function(e){return e.withdraw})),l=(0,q.Q)({tryPermit:!1,handleGetTxns:function(){var e=(0,H.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u({reserve:n,amount:r,aTokenAddress:t.aTokenAddress}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),skip:!r||0===parseFloat(r)||i,deps:[r,n],eventTxInfo:{amount:r,assetName:t.name,asset:t.underlyingAsset},protocolAction:L.UQ.withdraw}),d=l.action,p=l.loadingTxns,h=l.mainTxState,x=l.approvalTxState,m=l.approval,b=l.requiresApproval;return(0,X.jsx)(K.B,{blocked:i,preparingTransactions:p,approvalTxState:x,mainTxState:h,amount:r,isWrongNetwork:a,requiresAmount:!0,actionInProgressText:(0,X.jsx)(s.cC,{id:"Withdrawing {symbol}",values:{symbol:o}}),actionText:(0,X.jsx)(s.cC,{id:"Withdraw {symbol}",values:{symbol:o}}),handleAction:d,handleApproval:function(){return m([{amount:r,underlyingAsset:n}])},requiresApproval:b,sx:c})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(de||(de={}));var me,be=function(e){var t=e.poolReserve,r=e.userReserve,n=e.unwrap,a=e.setUnwrap,l=e.symbol,d=e.isWrongNetwork,p=(0,c.vR)(),h=p.gasLimit,x=p.mainTxState,b=p.txError,v=(0,i.HT)().user,T=(0,u.f)().currentNetworkConfig,O=(0,o.useState)(""),A=O[0],j=O[1],R=(0,o.useState)(""),H=R[0],P=R[1],N=(0,o.useState)(!1),Z=N[0],L=N[1],U=(0,o.useRef)(""),B=(0,S.Yh)((function(e){return e.trackEvent})),F="-1"===A,q=k(v,r,t),V=(0,m.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),G=(0,m.hE)(t.unborrowedLiquidity),Y=F?q.toString(10):A,Q=(0,E.Vc)(v),z=(0,W.DX)({user:v,userReserve:r,poolReserve:t,withdrawAmount:Y}),K=ce({assetsBlockingWithdraw:Q,poolReserve:t,healthFactorAfterWithdraw:z,withdrawAmount:Y}),J=K.blockingError,$=K.errorComponent,ee=z.toNumber()>=1&&z.toNumber()<1.5&&r.usageAsCollateralEnabledOnUser,te=(0,m.hE)(Y).multipliedBy((null===r||void 0===r?void 0:r.reserve.priceInUSD)||0);return x.success?(0,X.jsx)(he.R,{action:(0,X.jsx)(s.cC,{id:"withdrew"}),amount:U.current,symbol:n&&t.isWrappedBaseAsset?T.baseAssetSymbol:t.symbol}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(I.W,{value:Y,onChange:function(e){var t="-1"===e;U.current=t?q.toString(10):e,j(e),t&&q.eq(V)?(B(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"}),P("-1")):P(q.toString(10))},symbol:l,assets:[{balance:q.toString(10),symbol:l,iconSymbol:n&&t.isWrappedBaseAsset?T.baseAssetSymbol:t.iconSymbol}],usdValue:te.toString(10),isMaxSelected:F,disabled:x.loading,maxValue:q.toString(10),balanceText:G.lt(V)?(0,X.jsx)(s.cC,{id:"Available"}):(0,X.jsx)(s.cC,{id:"Supply balance"})}),void 0!==J&&(0,X.jsx)(g.Z,{variant:"helperText",color:"error.main",children:$}),t.isWrappedBaseAsset&&(0,X.jsx)(C.Pu,{unwrapped:n,setUnWrapped:a,label:(0,X.jsx)(g.Z,{children:"Unwrap ".concat(t.symbol," (to withdraw ").concat(T.baseAssetSymbol,")")})}),(0,X.jsxs)(C.m6,{gasLimit:h,children:[(0,X.jsx)(C.oD,{description:(0,X.jsx)(s.cC,{id:"Remaining supply"}),value:V.minus(Y||"0").toString(10),symbol:t.isWrappedBaseAsset?T.baseAssetSymbol:t.symbol}),(0,X.jsx)(C.jz,{visibleHfChange:!!A,healthFactor:v?v.healthFactor:"-1",futureHealthFactor:z.toString(10)})]}),b&&(0,X.jsx)(D.Q,{txError:b}),ee&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(w.v,{severity:"error",sx:{my:6},children:(0,X.jsx)(s.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,X.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,X.jsx)(y.Z,{checked:Z,onChange:function(){L(!Z),B(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:Z})},size:"small","data-cy":"risk-checkbox"}),(0,X.jsx)(g.Z,{variant:"description",children:(0,X.jsx)(s.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,X.jsx)(xe,{poolReserve:t,amountToWithdraw:F?H:Y,poolAddress:n&&t.isWrappedBaseAsset?M.hP:t.underlyingAsset,isWrongNetwork:d,symbol:l,blocked:void 0!==J||ee&&!Z,sx:ee?{mt:0}:{}})]})},fe=r(34637),ve=r(59379);function ge(e){var t,r=e.withdrawType,n=e.setWithdrawType,a=(0,u.f)().currentMarketData,o=(0,S.Yh)((function(e){return e.trackEvent}));return null!==(t=a.enabledFeatures)&&void 0!==t&&t.collateralRepay?(0,X.jsx)(f.Z,{sx:{mb:6},children:(0,X.jsxs)(ve.f,{color:"primary",value:r,exclusive:!0,onChange:function(e,t){return n(t)},children:[(0,X.jsx)(fe.Y,{value:me.WITHDRAW,disabled:r===me.WITHDRAW,onClick:function(){return o(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw"})},children:(0,X.jsx)(g.Z,{variant:"buttonM",children:(0,X.jsx)(s.cC,{id:"Withdraw"})})}),(0,X.jsx)(fe.Y,{value:me.WITHDRAWSWITCH,disabled:r===me.WITHDRAWSWITCH,onClick:function(){return o(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw and Switch"})},children:(0,X.jsx)(g.Z,{variant:"buttonM",children:(0,X.jsx)(s.cC,{id:"Withdraw & Switch"})})})]})}):null}function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.WITHDRAW=0]="WITHDRAW",e[e.WITHDRAWSWITCH=1]="WITHDRAWSWITCH"}(me||(me={}));var we=function(){var e=(0,c.vR)(),t=e.type,r=e.close,n=e.args,x=e.mainTxState,m=(0,o.useState)(!0),b=m[0],f=m[1],v=(0,o.useState)(me.WITHDRAW),g=v[0],y=v[1],T=(0,u.f)().currentMarketData,w=(0,i.HT)().reserves,O=(0,l.hN)(w),A=d.cr.withdrawAndSwitch(T)&&n.underlyingAsset!==(null===O||void 0===O?void 0:O.underlyingAsset);return(0,X.jsx)(p.P,{open:t===c.w8.Withdraw,setOpen:function(){y(me.WITHDRAW),r()},children:(0,X.jsx)(h.A,{title:(0,X.jsx)(s.cC,{id:"Withdraw"}),underlyingAsset:n.underlyingAsset,keepWrappedSymbol:!b,requiredPermission:a.g.DEPOSITOR,children:function(e){return(0,X.jsxs)(X.Fragment,{children:[A&&!x.txHash&&(0,X.jsx)(ge,{withdrawType:g,setWithdrawType:y}),g===me.WITHDRAW&&(0,X.jsx)(be,Te(Te({},e),{},{unwrap:b,setUnwrap:f})),g===me.WITHDRAWSWITCH&&(0,X.jsx)(X.Fragment,{children:(0,X.jsx)(pe,Te({},e))})]})}})})}}}]);