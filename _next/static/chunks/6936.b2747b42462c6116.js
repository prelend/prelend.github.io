"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6936],{84734:function(e,t,r){r.d(t,{v:function(){return o}});var s=r(49501),n=r(68861),a=r(85893),o=function(){return(0,a.jsx)(s.cC,{id:"<0>Ampleforth</0> is a rebasing asset. Visit the <1>documentation</1> to learn more.",components:{0:(0,a.jsx)("b",{}),1:(0,a.jsx)(n.rU,{href:"https://docs.aave.com/developers/v/2.0/guides/ampl-asset-listing",underline:"always"})}})}},86936:function(e,t,r){r.r(t),r.d(t,{SupplyModal:function(){return ce}});var s=r(59499),n=r(49501),a=r(23286),o=r(67294),i=r(8195),l=r(31959),c=r(94635),u=r(80854),p=r(82403),d=r(1279),m=r(20854),y=r(70794),b=r(69331),f=r(84734),v=r(43629),h=r(46930),g=r(8656),x=r(94847),j=r(63206),A=r(57609),O=r(87385),C=r(34220),S=r(81902),w=r(53601),P=r(67916),k=r(93608),T=r(57824),E=r(94671),D=r(29630),I=r(68346),B=r(68861),M=r(85893),R=function(){return(0,M.jsx)(b.v,{severity:"info",children:(0,M.jsxs)(D.Z,{children:[(0,M.jsx)(n.cC,{id:"Supplying your"})," AAVE"," ",(0,M.jsx)(n.cC,{id:"tokens is not the same as staking them. If you wish to stake your"})," AAVE"," ",(0,M.jsx)(n.cC,{id:"tokens, please go to the"})," ",(0,M.jsx)(I.Z,{href:B.Z6.staking,children:(0,M.jsx)(n.cC,{id:"staking view"})})]})})},N=r(18384),W=function(){return(0,M.jsx)(b.v,{severity:"warning",children:(0,M.jsxs)(D.Z,{children:[(0,M.jsx)(n.cC,{id:"Before supplying"})," SNX"," ",(0,M.jsx)(n.cC,{id:"please check that the amount you want to supply is not currently being used for staking. If it is being used for staking, your transaction might fail."})]})})},L=r(50029),Z=r(17674),U=r(4730),q=r(87794),F=r.n(q),Q=r(75331),_=r(56371),H=r(30194),V=r(19419),G=r(28744),Y=r(93591),z=r(77537),X=r(32113),$=r(39771),K=r(31001),J=r(67489),ee=["amountToSupply","poolAddress","isWrongNetwork","sx","symbol","blocked","decimals","isWrappedBaseAsset"];function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var se,ne=o.memo((function(e){var t=e.amountToSupply,r=e.poolAddress,s=e.isWrongNetwork,a=e.sx,l=e.symbol,c=e.blocked,p=e.decimals,d=e.isWrappedBaseAsset,m=(0,U.Z)(e,ee),y=(0,g.Yh)((function(e){return[e.tryPermit,e.supply,e.supplyWithPermit,e.walletApprovalMethodPreference,e.estimateGasLimit,e.addTransaction,e.currentMarketData]})),b=(0,Z.Z)(y,7),f=b[0],v=b[1],h=b[2],x=b[3],j=b[4],A=b[5],O=b[6],C=(0,i.vR)(),S=C.approvalTxState,w=C.mainTxState,P=C.loadingTxns,k=C.setLoadingTxns,T=C.setApprovalTxState,D=C.setMainTxState,I=C.setGasLimit,B=C.setTxError,R=(0,V.n)(),N=R.refetchPoolData,W=R.refetchIncentiveData,q=R.refetchGhoData,te=f({reserveAddress:r,isWrappedBaseAsset:d}),se=(0,z.Z)().sendTx,ne=(0,o.useState)(),ae=ne[0],oe=ne[1],ie=(0,Y.y)(O,r),le=ie.data,ce=ie.refetch,ue=ie.isRefetching,pe=ie.isFetchedAfterMount;k(ue);var de=0!==Number(t)&&(0,E.iv)({approvedAmount:(null===le||void 0===le?void 0:le.amount)||"0",amount:t,signedAmount:ae?ae.amount:"0"});de&&null!==S&&void 0!==S&&S.success&&T({});var me=te&&x===X.n.PERMIT,ye=(0,G.M)({usePermit:me,approvedAmount:le,requiresApproval:de,assetAddress:r,symbol:l,decimals:p,signatureAmount:t,onApprovalTxConfirmed:ce,onSignTxCompleted:function(e){return oe(e)}}).approval;(0,o.useEffect)((function(){pe||ce()}),[ce,pe]),(0,o.useEffect)((function(){var e=0;me?e=Number(u.eB[Q.UQ.supplyWithPermit].recommended):(e=Number(u.eB[Q.UQ.supply].recommended),de&&!S.success&&(e+=Number(E.pQ))),I(e.toString())}),[de,S,me,I]);var be=function(){var e=(0,L.Z)(F().mark((function e(){var s,n,a,o,i;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,D(re(re({},w),{},{loading:!0})),n=Q.UQ.default,!me||!ae){e.next=16;break}return n=Q.UQ.supplyWithPermit,a=h({signature:ae.signature,amount:(0,_.parseUnits)(t,p).toString(),reserve:r,deadline:ae.deadline}),e.next=8,j(a);case 8:return a=e.sent,e.next=11,se(a);case 11:return s=e.sent,e.next=14,s.wait(1);case 14:e.next=26;break;case 16:return n=Q.UQ.supply,o=v({amount:(0,_.parseUnits)(t,p).toString(),reserve:r}),e.next=20,j(o);case 20:return o=e.sent,e.next=23,se(o);case 23:return s=e.sent,e.next=26,s.wait(1);case 26:D({txHash:s.hash,loading:!1,success:!0}),A(s.hash,{action:n,txState:"success",asset:r,amount:t,assetName:l}),H.queryClient.invalidateQueries({queryKey:K.B.pool}),N&&N(),W&&W(),q&&q(),e.next=39;break;case 34:e.prev=34,e.t0=e.catch(0),i=(0,$.WG)(e.t0,$.aD.GAS_ESTIMATION,!1),B(i),D({txHash:void 0,loading:!1});case 39:case"end":return e.stop()}}),e,null,[[0,34]])})));return function(){return e.apply(this,arguments)}}();return(0,M.jsx)(J.B,re({blocked:c,mainTxState:w,approvalTxState:S,isWrongNetwork:s,requiresAmount:!0,amount:t,symbol:l,preparingTransactions:P||!le,actionText:(0,M.jsx)(n.cC,{id:"Supply {symbol}",values:{symbol:l}}),actionInProgressText:(0,M.jsx)(n.cC,{id:"Supplying {symbol}",values:{symbol:l}}),handleApproval:ye,handleAction:be,requiresApproval:de,tryPermit:te,sx:a},m))}));function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.CAP_REACHED=0]="CAP_REACHED"}(se||(se={}));var ie=o.memo((function(e){var t,r=e.underlyingAsset,s=e.poolReserve,a=e.userReserve,l=e.isWrongNetwork,c=e.nativeBalance,D=e.tokenBalance,I=(0,C.HT)(),B=I.marketReferencePriceInUsd,L=I.user,Z=(0,h.f)(),U=Z.currentMarketData,q=Z.currentNetworkConfig,F=(0,i.vR)(),Q=F.mainTxState,_=F.gasLimit,H=F.txError,V=(0,v.ov)(),G=V.supplyCap,Y=V.debtCeiling,z=(0,g.Yh)((function(e){return e.poolComputed.minRemainingBaseTokenBalance})),X=(0,o.useState)(""),$=X[0],K=X[1],J=r.toLowerCase()===u.hP.toLowerCase(),ee=J?c:D,te=s.supplyAPY,re=s.supplyCap,se=s.totalLiquidity,ae=s.isFrozen,ie=s.decimals,le=s.debtCeiling,ce=s.isolationModeTotalDebt,ue=(0,o.useMemo)((function(){return(0,x.I)(ee,{supplyCap:re,totalLiquidity:se,isFrozen:ae,decimals:ie,debtCeiling:le,isolationModeTotalDebt:ce},r,z)}),[ee,re,se,ae,ie,le,ce,r,z]),pe=new y.Z($).multipliedBy(s.formattedPriceInMarketReferenceCurrency),de=pe.multipliedBy(B).shiftedBy(-p.$3),me=L?(0,d.hE)(L.totalCollateralMarketReferenceCurrency).plus(pe):"-1",ye=L?(0,d.hE)(L.totalCollateralMarketReferenceCurrency).multipliedBy(L.currentLiquidationThreshold).plus(pe.multipliedBy(s.formattedReserveLiquidationThreshold)).dividedBy(me):"-1",be=$===ue,fe=L?(0,d.hE)(L.healthFactor):"-1";L&&(!L.isInIsolationMode&&!s.isIsolated||L.isInIsolationMode&&(null===(t=L.isolatedReserve)||void 0===t?void 0:t.underlyingAsset)===s.underlyingAsset)&&(fe=(0,m.L1)({collateralBalanceMarketReferenceCurrency:me,borrowBalanceMarketReferenceCurrency:(0,d.hE)(L.totalBorrowsMarketReferenceCurrency),currentLiquidationThreshold:ye}));var ve=L.userReservesData.find((function(e){return e.usageAsCollateralEnabledOnUser&&e.reserve.id!==s.id})),he=!L.isInIsolationMode&&s.isIsolated&&!ve&&(!a||"0"===a.underlyingBalance||a.usageAsCollateralEnabledOnUser),ge={address:s.aTokenAddress,symbol:"pre"+(s.isWrappedBaseAsset?q.baseAssetSymbol:s.iconSymbol),decimals:s.decimals,aToken:!0,iconSymbol:s.isWrappedBaseAsset?q.baseAssetSymbol:s.iconSymbol},xe=(0,E.yI)(a,L.totalCollateralUSD,L.isInIsolationMode,Y.isMaxed),je={amountToSupply:$,isWrongNetwork:l,poolAddress:J?u.hP:s.underlyingAsset,symbol:J?q.baseAssetSymbol:s.symbol,blocked:!1,decimals:s.decimals,isWrappedBaseAsset:s.isWrappedBaseAsset};return Q.success?(0,M.jsx)(k.R,{action:(0,M.jsx)(n.cC,{id:"Supplied"}),amount:$,symbol:J?q.baseAssetSymbol:s.symbol,addToken:ge}):(0,M.jsxs)(M.Fragment,{children:[he&&(0,M.jsx)(N.i,{asset:s.symbol}),G.determineWarningDisplay({supplyCap:G}),Y.determineWarningDisplay({debtCeiling:Y}),"AMPL"===s.symbol&&(0,M.jsx)(b.v,{sx:{mt:"16px",mb:"40px"},severity:"warning",children:(0,M.jsx)(f.v,{})}),"AAVE"===s.symbol&&j.cr.staking(U)&&(0,M.jsx)(R,{}),"SNX"===s.symbol&&"0"!==ue&&(0,M.jsx)(W,{}),(0,M.jsx)(w.W,{value:$,onChange:function(e){if("-1"===e)K(ue);else{var t=(0,O.$w)(e,s.decimals);K(t)}},usdValue:de.toString(10),symbol:J?q.baseAssetSymbol:s.symbol,assets:[{balance:ue,symbol:J?q.baseAssetSymbol:s.symbol,iconSymbol:J?q.baseAssetSymbol:s.iconSymbol}],capType:S.R.supplyCap,isMaxSelected:be,disabled:Q.loading,maxValue:ue,balanceText:(0,M.jsx)(n.cC,{id:"Wallet balance"}),event:{eventName:A.vh.MAX_INPUT_SELECTION,eventParams:{asset:s.underlyingAsset,assetName:s.name}}}),(0,M.jsxs)(T.m6,{gasLimit:_,skipLoad:!0,disabled:0===Number($),children:[(0,M.jsx)(T.oD,{description:(0,M.jsx)(n.cC,{id:"Supply APY"}),value:te,percent:!0}),(0,M.jsx)(T.aE,{incentives:s.aIncentivesData,symbol:s.symbol}),(0,M.jsx)(T.Bx,{collateralType:xe}),(0,M.jsx)(T.jz,{visibleHfChange:!!$,healthFactor:L?L.healthFactor:"-1",futureHealthFactor:fe.toString(10)})]}),H&&(0,M.jsx)(P.Q,{txError:H}),(0,M.jsx)(ne,oe({},je))]})}));function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}var ce=function(){var e=(0,i.vR)(),t=e.type,r=e.close,o=e.args;return(0,M.jsx)(l.P,{open:t===i.w8.Supply,setOpen:r,children:(0,M.jsx)(c.A,{action:"supply",title:(0,M.jsx)(n.cC,{id:"Supply"}),underlyingAsset:o.underlyingAsset,requiredPermission:a.g.DEPOSITOR,children:function(e){return(0,M.jsx)(ie,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))}})})}},18384:function(e,t,r){r.d(t,{i:function(){return l}});var s=r(49501),n=r(29630),a=r(68861),o=r(69331),i=r(85893),l=function(e){var t=e.asset,r=e.severity;return(0,i.jsxs)(o.v,{severity:r||"info",sx:{mb:3},children:[(0,i.jsx)(n.Z,{variant:"subheader1",mb:.5,children:(0,i.jsx)(s.cC,{id:"You are entering Isolation mode"})}),(0,i.jsx)(n.Z,{children:(0,i.jsx)(s.cC,{id:"In Isolation mode, you cannot supply other assets as collateral. A global debt ceiling limits the borrowing power of the isolated asset. To exit isolation mode disable {0} as collateral before borrowing another asset. Read more in our <0>FAQ</0>",values:{0:t||""},components:{0:(0,i.jsx)(a.rU,{href:"https://docs.aave.com/faq/aave-v3-features#isolation-mode"})}})})]})}},94847:function(e,t,r){r.d(t,{x:function(){return i},I:function(){return l}});var s=r(80854),n=r(1279),a=r(70794),o=r(87385);function i(e,t){return"0"===e?new a.Z(-1):new a.Z(e).minus(t)}function l(e,t,r,l){if(t.isFrozen)return"0";var c=(0,n.hE)(e);return c.gt(0)&&r.toLowerCase()===s.hP.toLowerCase()&&(c=c.minus(l)),"0"!==t.supplyCap&&(c=a.Z.min(c,i(t.supplyCap,t.totalLiquidity))),c.lte(0)?"0":(0,o.$w)(c.toString(10),t.decimals)}}}]);